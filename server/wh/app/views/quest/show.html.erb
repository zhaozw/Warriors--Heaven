<html>
<head>
</head>
<script src="/javascripts/jquery-1.3.2.js"></script>
<script>
function doAction(action_name){
//	alert(action_name);
	$.ajax({
			type: "post",
			url: "/quest/doAction"+"?t="+ new Date().getTime(),
			data: {
				quest: '<%=@quest_name %>',
				action1: action_name,
				sid: '<%=@sid%>',
				authenticity_token:window._token
			}, 
			success: function(data, textStatus){
			//	 alert( "Data Saved: " + data +","+ textStatus);
			//	$("#memopad").css("display", "block");
			    $("#result").html( $("#result").html()+data);
			$("#result").attr("scrollTop",$("#result").attr('scrollHeight'));
			//hasMemo=1;
			},
			error: function(xhr, textStatus, errorThrow){
				alert("error"+errorThrow+","+textStatus+","+xhr.responseText);
			}
	});
}

</script>
<body style="background:transparent;background-color:transparent;width:320px;margin:0;padding:0;border:0px solid red;">
<div id="bg" style="z-index:-1;position:absolute;left:0;top:0;width:320px;height: 430px;">
	<img id="bg" src="<%=@quest.bgimage%>" style="margin:10 0;height:480px;"/>
</div>
<div id="main" style="display:none;background:transparent;background-color: transparent;margin:25px;">
	<div >
		<span style="font-weight:bold;font-size:18pt;">
			Quest
		</span>
		<img src="/images/line1.png">
	</div>
	<div id="title" style="margin-top:10px;">
		<img src="<%=@quest.logo %>" style="border:0px;width:60px;float:left;" />
		
		<div id="desc" style="margin-left:65px;padding-top:5px;border:0px solid red;">
			<span><%=@quest.dname %></span><br/>
			<span style="font-color:yellow; font-size:9pt;height:10px;">
				<%=@quest.desc%>
			</span>
		</div>
	</div>
	<div style="border:1px solid #333333;width:100px;background:#999999;">
		<div id="pro_left" style="float:left;background:green;height:6px;width:50px;"></div>
		<div id="pro_right" style="background:transparent;height:6px;width:50px;"></div>
	</div>
	
	<div id="room" style="background:transparent;background-color: transparent;">
		<%=@quest.room%>
	</div>
	
	<div id="action_list">
		<% for action in @quest.action_list %>
		<button type='button' onclick="doAction('<%=action[:name] %>')"><%=action[:dname] %></button>
		<% end %>
	</div>
	<div id="result" style="height:100px;overflow-y:auto;">
	</div>
</div>

</body>
</html>

<script>
proccess();
var v = setInterval('proccess();',1000);
function proccess(){
	//alert($("img#bg")[0].width);
	if ($("img#bg")[0].width>300){
		$("div#main").css("display", "block");
		clearInterval(v);
		// alert("load complete");
	}
//	else
//		setInterval('proccess();',100);
		
}

// alert("dfs");
</script>